<?xml version="1.0"?>
<configuration>

    <mmio>
        <bar name="MCHBAR"   register="PCI0.0.0_MCHBAR" base_field="MCHBAR" size="0x8000" enable_bit="0" desc="Host Memory Mapped Register Range"/>
        <bar name="MMCFG"    register="PCI0.0.0_PCIEXBAR" base_field="PXPEPBAR" size="0x1000" enable_bit="0" desc="PCI Express Register Range"/>
        <bar name="VTBAR"    register="VTBAR"    base_field="Base" size="0x1000" enable_field="Enable" desc="Intel VT-d Register Register Range"/>
        <bar name="GFXVTBAR" register="GFXVTBAR" base_field="Base" size="0x1000" enable_field="Enable" desc="Intel Processor Graphics VT-d Register Range"/>
    </mmio>

    <!-- #################################### -->
    <!--                                      -->
    <!-- Configuration registers              -->
    <!--                                      -->
    <!-- #################################### -->
    <registers>
        <!-- Host Controller -->
        <register name="PCI0.0.0_VID"        type="pcicfg" offset="0x0"  size="2" desc="Vendor ID"/>
        <register name="PCI0.0.0_DID"        type="pcicfg" offset="0x2"  size="2" desc="Device ID"/>

        <register name="PCI0.0.0_MCHBAR"     type="pcicfg" offset="0x48" size="8" desc="MCH Base Address">
            <field name="MCHBAR" bit="15" size="24" desc="Base Address for Host Memory Mapped configuration space"/>
            <field name="MCHBAREN" bit="0" size="1" desc="Enabled/Disabled"/>
        </register>

        <register name="PCI0.0.0_GGC" type="pcicfg" offset="0x50" size="2" desc="Graphics Control">
            <field name="GMS"     bit="8" size="8" desc="GMS" />
            <field name="GGMS"    bit="6" size="2" desc="GGMS" />
            <field name="VAMEN"   bit="2" size="1" desc="VAMEN" />
            <field name="IVD"     bit="1" size="1" desc="IVD" />
            <field name="GGCLOCK" bit="0" size="1" desc="GGC Lock"/>
        </register>

        <register name="PCI0.0.0_DEVEN"      type="pcicfg" offset="0x54" size="4" desc="Device Enables">
            <field name="D2EN" bit="4" size="1" desc="Device 2 Function 0 Enable" />
        </register>

        <register name="PCI0.0.0_PAVPC" type="pcicfg" offset="0x58" size="4" desc="PAVP Control">
            <field name="PCMBASE" bit="20" size="12" desc="PCMBASE" />
            <field name="ASMFEN" bit="6" size="1" desc="ASMF Method Enable" />
            <field name="OVTATTACK" bit="4" size="1" desc="Override Unsolicited Connection State Attack and Terminate" />
            <field name="PAVPLCK" bit="2" size="1" desc="PAVP Lock" />
            <field name="PAVPE" bit="1" size="1" desc="PAVP Enable" />
            <field name="PCME" bit="0" size="1" desc="PCM Enable" />
        </register>

        <register name="PCI0.0.0_PCIEXBAR" type="pcicfg" offset="0x60" size="8" desc="PCIe MMCFG Base Address">
            <field name="PXPEPBAR" bit="28" size="11" desc="Bits 38 to 28 of the base address for PCI Express enhanced configuration space"/>
            <field name="ADMSK128" bit="27" size="1" desc="Part of BA or Mask"/>
            <field name="ADMSK64" bit="26" size="1" desc="Part of BA or Mask"/>
            <field name="LENGTH" bit="1" size="2" desc="Length of the Region"/>
            <field name="PCIEXBAREN" bit="0" size="1" desc="Enabled/Disabled"/>
        </register>

        <register name="PCI0.0.0_TOUUD"      type="pcicfg" offset="0xA8" size="8" desc="Top of Upper Usable DRAM">
            <field name="TOUUD"      bit="20" size="19" desc="Top of Upper Usable DRAM"/>
            <field name="LOCK"       bit="0"  size="1" desc="Lock"/>
        </register>

        <register name="PCI0.0.0_BDSM"       type="pcicfg" offset="0xB0" size="4" desc="Base of Graphics Stolen Memory">
            <field name="BDSM" bit="20" size="12" desc="Base Address of Stolen DRAM memory"/>
            <field name="LOCK"       bit="0" size="1" desc="Lock"/>
        </register>

        <register name="PCI0.0.0_BGSM"       type="pcicfg" offset="0xB4" size="4" desc="Base of GTT Stolen Memory">
            <field name="BGSM"       bit="20" size="12" desc="Base of GTT Stolen Memory"/>
            <field name="LOCK"       bit="0"  size="1"  desc="Lock"/>
        </register>

        <register name="PCI0.0.0_TSEGMB"     type="pcicfg" offset="0xB8" size="4" desc="TSEG Memory Base">
            <field name="TSEGMB"     bit="20" size="12" desc="TSEG Memory Base"/>
            <field name="LOCK"       bit="0"  size="1"  desc="Lock"/>
        </register>

        <register name="PCI0.0.0_TOLUD"      type="pcicfg" offset="0xBC" size="4" desc="Top of Low Usable DRAM">
            <field name="TOLUD"      bit="20" size="12" desc="Top of Lower Usable DRAM"/>
            <field name="LOCK"       bit="0"  size="1"  desc="Lock"/>
        </register>

        <register name="PCI0.0.0_CAPID0_A"   type="pcicfg" offset="0xE4" size="4" desc="Capabilities A"/>
            <field name="VTDD" bit="23" size="1" desc="Enable/Disable VTd"/>
        <register name="PCI0.0.0_CAPID0_B"   type="pcicfg" offset="0xE8" size="4" desc="Capabilities B"/>

        <register name="GFXVTBAR" type="mmio" bar="MCHBAR" offset="0x5400" size="8" desc="Processor Graphics VT-d MMIO Base Address">
            <field name="Enable" bit="0"  size="1" desc="Enable"/>
            <field name="Base"   bit="12" size="27" desc="GFX VTD Base Address"/>
        </register>

        <register name="VTBAR" type="mmio" bar="MCHBAR" offset="0x5410" size="8" desc="VT-d MMIO Base Address">
            <field name="Enable" bit="0"  size="1"  desc="Enable"/>
            <field name="Base"   bit="12" size="27" desc="VTD Base Address"/>
        </register>
    </registers>

    <controls>
        <control name="TSEGBaseLock"           register="PCI0.0.0_TSEGMB"      field="LOCK"               desc="TSEG Base Lock"/>
        <control name="TSEGLimitLock"          register="PCI0.0.0_BGSM"        field="LOCK"               desc="TSEG Limit Lock"/>
    </controls>

</configuration>